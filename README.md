# mrarchive
病案归档管理系统
病 案 归 档 管 理 系 统

分享路径：https://share.weiyun.com/5tnvCWb
编程语言:python3.7+pyqt5
数据库:广东省医院统计病案管理系统现成SQL数据库
 
正式说明：
运行环境:
Win7以上，（因为python3.7不支持xp）。
安装vc++2005运行库 。
设置好配置文件111.txt，主要是远程服务器选择ip地址，还有就是数据库名称密码，一定要按原来一行一行的格式。

数据库说明：使用广东省医院统计病案管理系统现成数据库
HIS_ba1、HIS_ba2HIS_ba9  病案首页中间表，主要表 （数据由HIS导入）
Tpatientvisit	病人住院信息，主要表
tbaSubmit  病案归档登记表  主要表
Tplaytime  节假日表 次要表，计算归档时间时排除节假日
TSYSUSER系统用户表 次要表 登录后可以记录归档操作员，不录入可以忽略。

运行逻辑思路:
名称说明：已归档：在tbaSubmit表插入记录  （归档员操作）
          已录入：在Tpatientvisit表输入首页（编码员操作）
运行说明：全程数据以病案号fprn + 出院日期fcydate 为唯一索引。
根据数据在中间表和主要表的情况分为四种状态：已归档未录入、已归档已录入
                          未归档未录入、未归档已录入
当进行归档录入操作时，自动根据四种情况判断是否需要归档，在查询以及报表输出时，
会将这四种情况进行提示。


功能特色: 广东省医院统计病案管理系统全外挂程序。
广东省医院统计病案管理系统的归档功能烂到无法忍耐。
一．	使用病案号+出院日期为唯一索引，能自主计算住院次数（不使用导入的住院次数）。
这样除了归档录入时麻烦一些，后期的查询、报表、打印都可以准确定位到需要的记录。
二．查询功能涵盖四种状况，只要从HIS导入，就能通过模糊，组合查询到。还附赠查询
在Tpatientvisit表里重复录入的病案号+出院日期首页记录（重复记录还是经常有的）。
三．报表功能彩蛋多多，能自动跳过周六日和节假日（Tplaytime表自己添加部分公众假期），
计算出归档日期和出院日期的时间差，保存为XLS表。
四．打印使用外挂的外挂，全DIY套打，自己设置模版（可以先试用本院的模版），选择科室批量打印（科室根据查询结果自动刷新）。全部可以由操作员DIY设置，无需计算机人员另外设置。
五．免安装，免设置，如果一直使用tbaSubmit表的立刻即插即用。如果之前使用其他数据库的，先将旧数据库里的fprn\fcydate\fsjdate(归档日期)三个字段的数据导入tbaSubmit表。如果只使用其中的一两个功能也完全可以，能与广东省医院统计病案管理系统的归档功能同时使用（好像借阅功能还好吧）。

使用注意:
1 由于使用病案号+出院日期为唯一索引，需要tbaSubmit表和另外两个主表唯一索引关联时才能查询到结果。但经常发生出院日期不一致情况：有导入记录和纸质首页的出院日期不一致，有录入首页和纸质首页出院日期不一致。解决方法：在确认了已经导入数据后，先通过住院号的模糊查询查找到该记录，查看出院日期，确定和纸质首页不相同，提示编码员修改，（可能修改纸质的，可能修改首页录入的）。录入首页后再进行归档。如果发现归档的出院日期是和录入首页的不符，可以删除该归档记录，重新选择新的出院日期进行归档。
2 使用病案号+出院日期为唯一索引的原因，是tbaSubmit（病案归档登记表）的唯一索引就是这样。但也就是在本系统发生作用，在涉及到tDiagnose(病人诊断信息)和tOperation（病人手术信息）还是必须使用FPRN + FTIMES（住院次数）作为唯一索引。由于数据从HIS系统导入省厅系统时，相对于FTIMES（住院次数），出院日期还是较为可靠些，（虽然实际使用时还是出现上述不一致情况）。最终的FTIMES（住院次数）的确认还必须靠编码员录入首页时注意。本系统的住院次数在打印时自动计算，没读取系统字段，可能两者有差异。
3 封面打印页排列顺序按归档录入时间正序（从早到晚），如果需要倒序（方便打印人员封面和病历合并），请自行在打印机设置里选择从后页往前页打印。
4 封面打印模版设置需要8个文本框，不然无法和打印输出字段数对应，如果需要添加或减少打印字段，只能通过本人修改程序了，暂时没有精力编写DIY字段。
5 HIS导入时有出院日期为空的情况，查询时显示2999年的出院日期作为提示，需要先录入首页时进行修改，或者在数据库后台修改，才能归档。
6 查询时归档日期为2111年的就是没有归档的提示。每页只显示10条记录，按出院日期排序，按下一页查询另10条记录。
